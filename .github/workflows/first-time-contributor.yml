name: 'First time contributor'
on:
  pull_request:
    types: [opened, labeled]

permissions:
  contents: read

jobs:
  welcome_first_contributor:
    permissions:
      issues: write
    runs-on: ubuntu-latest
    if: github.repository_owner == 'open-telemetry' && (github.event.pull_request.author_association == 'NONE' || github.event.label.name == 'first-contrib-test')
    steps:
      - run: gh pr edit "$NUMBER" --add-label "$LABELS"
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          GH_REPO: ${{ github.repository }}
          NUMBER: ${{ github.event.pull_request.number }}
          LABELS: 'first-time contributor'

      - name: Comment on PR
        uses: actions-ecosystem/action-create-comment@5b43c092bf96ebc715dbbe5682ecf3b771223855 # v1.0.0
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          body: |
            Welcome, contributor! Thank you for your contribution to opentelemetry-collector-contrib.

            **Important reminders:**
            - Please review our [Contributing Guidelines](https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/CONTRIBUTING.md).
            - Don't forget to sign the [Contributor License Agreement (CLA)](https://identity.linuxfoundation.org/projects/cncf) if you haven't already.
            
            A maintainer will review your pull request soon. Thank you for helping make OpenTelemetry better!