processors:
  alertsprocessor:
    sliding_window:
      duration: 5s
      max_samples: 10000
      overflow_behavior: ring_buffer
    evaluation:
      interval: 5s
      timeout: 5s
      max_concurrent: 4
    statestore:
      sync_interval: 30s
      instance_id: test
      external_labels:
        cluster: test
        source: collector
    deduplication:
      fingerprint_algorithm: sha256
      fingerprint_labels: ["alertname","cluster"]
    stormcontrol:
      global:
        max_active_alerts: 100
        max_alerts_per_minute: 50
    cardinality:
      labels:
        max_labels_per_alert: 20
        max_label_value_length: 128
        max_total_label_size: 2048
      allowlist: ["alertname","severity","cluster","service"]
    notifier:
      url: http://localhost:9093/api/v2/alerts
      timeout: 2s
      initial_interval: 200ms
      max_interval: 5s
      max_batch_size: 32
    rules:
      - id: high_error_logs
        name: HighErrorLogs
        signal: logs
        for: 0s
        labels: { severity: error }
        logs:
          severity_at_least: ERROR
          body_contains: "timeout"
          group_by: ["service.name"]
          count_threshold: 3
      - id: slow_spans
        name: SlowSpans
        signal: traces
        for: 2s
        labels: { severity: warning }
        traces:
          latency_ms_gt: 500
          status_not_ok: false
          group_by: ["service.name","span.name"]
          count_threshold: 2
