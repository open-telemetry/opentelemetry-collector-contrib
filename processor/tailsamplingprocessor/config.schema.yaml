$defs:
  and_cfg:
    description: AndCfg holds the common configuration to all and policies.
    type: object
    properties:
      and_sub_policy:
        type: array
        items:
          $ref: and_sub_policy_cfg
  and_sub_policy_cfg:
    description: AndSubPolicyCfg holds the common configuration to all policies under and policy.
    type: object
    properties:
      ExtensionCfg:
        description: Configs for any extensions that are used.
        type: object
        additionalProperties:
          type: object
          additionalProperties:
            x-customType: any
      boolean_attribute:
        description: Configs for boolean attribute filter sampling policy evaluator.
        $ref: boolean_attribute_cfg
      bytes_limiting:
        description: Configs for bytes limiting filter sampling policy evaluator.
        $ref: bytes_limiting_cfg
      latency:
        description: Configs for latency filter sampling policy evaluator.
        $ref: latency_cfg
      name:
        description: Name given to the instance of the policy to make easy to identify it in metrics and logs.
        type: string
      numeric_attribute:
        description: Configs for numeric attribute filter sampling policy evaluator.
        $ref: numeric_attribute_cfg
      ottl_condition:
        description: Configs for OTTL condition filter sampling policy evaluator
        $ref: ottl_condition_cfg
      probabilistic:
        description: Configs for probabilistic sampling policy evaluator.
        $ref: probabilistic_cfg
      rate_limiting:
        description: Configs for rate limiting filter sampling policy evaluator.
        $ref: rate_limiting_cfg
      span_count:
        description: Configs for span count filter sampling policy evaluator.
        $ref: span_count_cfg
      status_code:
        description: Configs for status code filter sampling policy evaluator.
        $ref: status_code_cfg
      string_attribute:
        description: Configs for string attribute filter sampling policy evaluator.
        $ref: string_attribute_cfg
      trace_state:
        description: Configs for defining trace_state policy
        $ref: trace_state_cfg
      type:
        description: Type of the policy this will be used to match the proper configuration of the policy.
        $ref: policy_type
  boolean_attribute_cfg:
    description: BooleanAttributeCfg holds the configurable settings to create a boolean attribute filter sampling policy evaluator.
    type: object
    properties:
      invert_match:
        description: InvertMatch indicates that values must not match against attribute values. If InvertMatch is true and Values is equal to 'true', all other values will be sampled except 'true'. Also, if the specified Key does not match any resource or span attributes, data will be sampled.
        type: boolean
      key:
        description: Tag that the filter is going to be matching against.
        type: string
      value:
        description: Value indicate the bool value, either true or false to use when matching against attribute values. BooleanAttribute Policy will apply exact value match on Value
        type: boolean
  bytes_limiting_cfg:
    description: BytesLimitingCfg holds the configurable settings to create a bytes limiting sampling policy evaluator using a token bucket algorithm.
    type: object
    properties:
      burst_capacity:
        description: BurstCapacity sets the maximum burst capacity in bytes. If not specified, defaults to 2x BytesPerSecond. This allows for short bursts of traffic above the sustained rate. It also acts as a limit for individual trace sizes, a single trace larger than the burst size will not pass.
        type: integer
        x-customType: int64
      bytes_per_second:
        description: BytesPerSecond sets the limit on the maximum number of bytes that can be processed each second.
        type: integer
        x-customType: int64
  composite_cfg:
    description: CompositeCfg holds the configurable settings to create a composite sampling policy evaluator.
    type: object
    properties:
      composite_sub_policy:
        type: array
        items:
          $ref: composite_sub_policy_cfg
      max_total_spans_per_second:
        type: integer
        x-customType: int64
      policy_order:
        type: array
        items:
          type: string
      rate_allocation:
        type: array
        items:
          $ref: rate_allocation_cfg
  composite_sub_policy_cfg:
    description: CompositeSubPolicyCfg holds the common configuration to all policies under composite policy.
    type: object
    properties:
      ExtensionCfg:
        description: Configs for any extensions that are used.
        type: object
        additionalProperties:
          type: object
          additionalProperties:
            x-customType: any
      and:
        description: Configs for and policy evaluator.
        $ref: and_cfg
      boolean_attribute:
        description: Configs for boolean attribute filter sampling policy evaluator.
        $ref: boolean_attribute_cfg
      bytes_limiting:
        description: Configs for bytes limiting filter sampling policy evaluator.
        $ref: bytes_limiting_cfg
      latency:
        description: Configs for latency filter sampling policy evaluator.
        $ref: latency_cfg
      name:
        description: Name given to the instance of the policy to make easy to identify it in metrics and logs.
        type: string
      numeric_attribute:
        description: Configs for numeric attribute filter sampling policy evaluator.
        $ref: numeric_attribute_cfg
      ottl_condition:
        description: Configs for OTTL condition filter sampling policy evaluator
        $ref: ottl_condition_cfg
      probabilistic:
        description: Configs for probabilistic sampling policy evaluator.
        $ref: probabilistic_cfg
      rate_limiting:
        description: Configs for rate limiting filter sampling policy evaluator.
        $ref: rate_limiting_cfg
      span_count:
        description: Configs for span count filter sampling policy evaluator.
        $ref: span_count_cfg
      status_code:
        description: Configs for status code filter sampling policy evaluator.
        $ref: status_code_cfg
      string_attribute:
        description: Configs for string attribute filter sampling policy evaluator.
        $ref: string_attribute_cfg
      trace_state:
        description: Configs for defining trace_state policy
        $ref: trace_state_cfg
      type:
        description: Type of the policy this will be used to match the proper configuration of the policy.
        $ref: policy_type
  decision_cache_config:
    type: object
    properties:
      non_sampled_cache_size:
        description: NonSampledCacheSize specifies the size of the cache that holds the non-sampled trace IDs. This value will be the maximum amount of trace IDs that the cache can hold before overwriting previous IDs. For effective use, this value should be at least an order of magnitude greater than Config.NumTraces. If left as default 0, a no-op DecisionCache will be used.
        type: integer
      sampled_cache_size:
        description: SampledCacheSize specifies the size of the cache that holds the sampled trace IDs. This value will be the maximum amount of trace IDs that the cache can hold before overwriting previous IDs. For effective use, this value should be at least an order of magnitude greater than Config.NumTraces. If left as default 0, a no-op DecisionCache will be used.
        type: integer
  drop_cfg:
    description: DropCfg holds the common configuration to all policies under drop policy.
    type: object
    properties:
      drop_sub_policy:
        type: array
        items:
          $ref: and_sub_policy_cfg
  latency_cfg:
    description: LatencyCfg holds the configurable settings to create a latency filter sampling policy evaluator
    type: object
    properties:
      threshold_ms:
        description: Lower bound in milliseconds. Retaining original name for compatibility
        type: integer
        x-customType: int64
      upper_threshold_ms:
        description: Upper bound in milliseconds.
        type: integer
        x-customType: int64
  not_cfg:
    description: NotCfg holds the configuration for the not policy.
    type: object
    properties:
      not_sub_policy:
        $ref: not_sub_policy_cfg
  not_sub_policy_cfg:
    description: NotSubPolicyCfg holds the common configuration to the policy under the not policy.
    type: object
    properties:
      ExtensionCfg:
        description: Configs for any extensions that are used.
        type: object
        additionalProperties:
          type: object
          additionalProperties:
            x-customType: any
      boolean_attribute:
        description: Configs for boolean attribute filter sampling policy evaluator.
        $ref: boolean_attribute_cfg
      bytes_limiting:
        description: Configs for bytes limiting filter sampling policy evaluator.
        $ref: bytes_limiting_cfg
      latency:
        description: Configs for latency filter sampling policy evaluator.
        $ref: latency_cfg
      name:
        description: Name given to the instance of the policy to make easy to identify it in metrics and logs.
        type: string
      numeric_attribute:
        description: Configs for numeric attribute filter sampling policy evaluator.
        $ref: numeric_attribute_cfg
      ottl_condition:
        description: Configs for OTTL condition filter sampling policy evaluator
        $ref: ottl_condition_cfg
      probabilistic:
        description: Configs for probabilistic sampling policy evaluator.
        $ref: probabilistic_cfg
      rate_limiting:
        description: Configs for rate limiting filter sampling policy evaluator.
        $ref: rate_limiting_cfg
      span_count:
        description: Configs for span count filter sampling policy evaluator.
        $ref: span_count_cfg
      status_code:
        description: Configs for status code filter sampling policy evaluator.
        $ref: status_code_cfg
      string_attribute:
        description: Configs for string attribute filter sampling policy evaluator.
        $ref: string_attribute_cfg
      trace_state:
        description: Configs for defining trace_state policy
        $ref: trace_state_cfg
      type:
        description: Type of the policy this will be used to match the proper configuration of the policy.
        $ref: policy_type
  numeric_attribute_cfg:
    description: NumericAttributeCfg holds the configurable settings to create a numeric attribute filter sampling policy evaluator.
    type: object
    properties:
      invert_match:
        description: InvertMatch indicates that values must not match against attribute values. If InvertMatch is true and Values is equal to '123', all other values will be sampled except '123'. Also, if the specified Key does not match any resource or span attributes, data will be sampled.
        type: boolean
      key:
        description: Tag that the filter is going to be matching against.
        type: string
      max_value:
        description: MaxValue is the maximum value of the attribute to be considered a match.
        type: integer
        x-customType: int64
      min_value:
        description: MinValue is the minimum value of the attribute to be considered a match.
        type: integer
        x-customType: int64
  ottl_condition_cfg:
    description: OTTLConditionCfg holds the configurable setting to create a OTTL condition filter sampling policy evaluator.
    type: object
    properties:
      error_mode:
        $ref: github.com/open-telemetry/opentelemetry-collector-contrib/pkg/ottl.error_mode
      span:
        type: array
        items:
          type: string
      spanevent:
        type: array
        items:
          type: string
  policy_cfg:
    description: PolicyCfg holds the common configuration to all policies.
    type: object
    properties:
      ExtensionCfg:
        description: Configs for any extensions that are used.
        type: object
        additionalProperties:
          type: object
          additionalProperties:
            x-customType: any
      and:
        description: Configs for defining and policy
        $ref: and_cfg
      boolean_attribute:
        description: Configs for boolean attribute filter sampling policy evaluator.
        $ref: boolean_attribute_cfg
      bytes_limiting:
        description: Configs for bytes limiting filter sampling policy evaluator.
        $ref: bytes_limiting_cfg
      composite:
        description: Configs for defining composite policy
        $ref: composite_cfg
      drop:
        description: Configs for defining drop policy
        $ref: drop_cfg
      latency:
        description: Configs for latency filter sampling policy evaluator.
        $ref: latency_cfg
      name:
        description: Name given to the instance of the policy to make easy to identify it in metrics and logs.
        type: string
      not:
        description: Configs for defining not policy
        $ref: not_cfg
      numeric_attribute:
        description: Configs for numeric attribute filter sampling policy evaluator.
        $ref: numeric_attribute_cfg
      ottl_condition:
        description: Configs for OTTL condition filter sampling policy evaluator
        $ref: ottl_condition_cfg
      probabilistic:
        description: Configs for probabilistic sampling policy evaluator.
        $ref: probabilistic_cfg
      rate_limiting:
        description: Configs for rate limiting filter sampling policy evaluator.
        $ref: rate_limiting_cfg
      span_count:
        description: Configs for span count filter sampling policy evaluator.
        $ref: span_count_cfg
      status_code:
        description: Configs for status code filter sampling policy evaluator.
        $ref: status_code_cfg
      string_attribute:
        description: Configs for string attribute filter sampling policy evaluator.
        $ref: string_attribute_cfg
      trace_state:
        description: Configs for defining trace_state policy
        $ref: trace_state_cfg
      type:
        description: Type of the policy this will be used to match the proper configuration of the policy.
        $ref: policy_type
  policy_type:
    description: PolicyType indicates the type of sampling policy.
    type: string
  probabilistic_cfg:
    description: ProbabilisticCfg holds the configurable settings to create a probabilistic sampling policy evaluator.
    type: object
    properties:
      hash_salt:
        description: 'HashSalt allows one to configure the hashing salts. This is important in scenarios where multiple layers of collectors have different sampling rates: if they use the same salt all passing one layer may pass the other even if they have different sampling rates, configuring different salts avoids that.'
        type: string
      sampling_percentage:
        description: 'SamplingPercentage is the percentage rate at which traces are going to be sampled. Defaults to zero, i.e.: no sample. Values greater or equal 100 are treated as "sample all traces".'
        type: number
        x-customType: float64
  rate_allocation_cfg:
    description: RateAllocationCfg used within composite policy
    type: object
    properties:
      percent:
        type: integer
        x-customType: int64
      policy:
        type: string
  rate_limiting_cfg:
    description: RateLimitingCfg holds the configurable settings to create a rate limiting sampling policy evaluator.
    type: object
    properties:
      spans_per_second:
        description: SpansPerSecond sets the limit on the maximum number of spans that can be processed each second.
        type: integer
        x-customType: int64
  span_count_cfg:
    description: SpanCountCfg holds the configurable settings to create a Span Count filter sampling policy evaluator
    type: object
    properties:
      max_spans:
        type: integer
        x-customType: int32
      min_spans:
        description: Minimum number of spans in a Trace
        type: integer
        x-customType: int32
  status_code_cfg:
    description: StatusCodeCfg holds the configurable settings to create a status code filter sampling policy evaluator.
    type: object
    properties:
      status_codes:
        type: array
        items:
          type: string
  string_attribute_cfg:
    description: StringAttributeCfg holds the configurable settings to create a string attribute filter sampling policy evaluator.
    type: object
    properties:
      cache_max_size:
        description: CacheMaxSize is the maximum number of attribute entries of LRU Cache that stores the matched result from the regular expressions defined in Values. CacheMaxSize will not be used if EnabledRegexMatching is set to false.
        type: integer
      enabled_regex_matching:
        description: EnabledRegexMatching determines whether match attribute values by regexp string.
        type: boolean
      invert_match:
        description: InvertMatch indicates that values or regular expressions must not match against attribute values. If InvertMatch is true and Values is equal to 'acme', all other values will be sampled except 'acme'. Also, if the specified Key does not match on any resource or span attributes, data will be sampled.
        type: boolean
      key:
        description: Tag that the filter is going to be matching against.
        type: string
      values:
        description: Values indicate the set of values or regular expressions to use when matching against attribute values. StringAttribute Policy will apply exact value match on Values unless EnabledRegexMatching is true.
        type: array
        items:
          type: string
  trace_state_cfg:
    description: TraceStateCfg holds the common configuration for trace states.
    type: object
    properties:
      key:
        description: Tag that the filter is going to be matching against.
        type: string
      values:
        description: Values indicate the set of values to use when matching against trace_state values.
        type: array
        items:
          type: string
description: Config holds the configuration for tail-based sampling.
type: object
properties:
  block_on_overflow:
    description: BlockOnOverflow determines the behavior when the component's NumTraces limit is reached. If true, the component will wait for space; otherwise, old traces will be evicted to make space.
    type: boolean
  decision_cache:
    description: DecisionCache holds configuration for the decision cache(s)
    $ref: decision_cache_config
  decision_wait:
    description: DecisionWait is the desired wait time from the arrival of the first span of trace until the decision about sampling it or not is evaluated.
    type: string
    format: duration
  decision_wait_after_root_received:
    description: DecisionWaitAfterRootReceived is the desired wait time from the arrival of the root span of trace until the decision about sampling it or not is evaluated.
    type: string
    format: duration
  drop_pending_traces_on_shutdown:
    description: DropPendingTracesOnShutdown will drop all traces that are part of batches that have not yet reached the decision wait when the processor is shutdown.
    type: boolean
  expected_new_traces_per_sec:
    description: ExpectedNewTracesPerSec sets the expected number of new traces sending to the tail sampling processor per second. This helps with allocating data structures with closer to actual usage size.
    type: integer
    x-customType: uint64
  maximum_trace_size_bytes:
    description: MaximumTraceSizeBytes is the largest size of a trace a decision will be made for. If the trace size exceeds this it will be dropped before the decision period to keep memory more predictable. A 0 value disables dropping large traces early.
    type: integer
    x-customType: uint64
  num_traces:
    description: NumTraces is the number of traces kept on memory. Typically most of the data of a trace is released after a sampling decision is taken.
    type: integer
    x-customType: uint64
  policies:
    description: PolicyCfgs sets the tail-based sampling policy which makes a sampling decision for a given trace when requested.
    type: array
    items:
      $ref: policy_cfg
  sample_on_first_match:
    description: Make decision as soon as a policy matches
    type: boolean
