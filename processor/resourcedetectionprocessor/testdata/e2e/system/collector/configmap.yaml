apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Name }}-config
  namespace: default
data:
  relay: |
    exporters:
      otlp_grpc:
        endpoint: {{ .HostEndpoint }}:4317
        tls:
          insecure: true
    extensions:
      health_check:
        endpoint: 0.0.0.0:13133
    processors:
      resourcedetection:
        detectors: [system]
        timeout: 2s
        override: false
        system:
          hostname_sources: ["os"]
          resource_attributes:
            host.name:
              enabled: true
            host.id:
              enabled: true
            host.arch:
              enabled: true
            host.ip:
              enabled: false
            host.mac:
              enabled: false
            os.type:
              enabled: true
            os.version:
              enabled: true
            os.description:
              enabled: true
    receivers:
      hostmetrics:
        collection_interval: 1s
        scrapers:
          cpu:
    service:
      telemetry:
        logs:
          level: "debug"
      extensions:
        - health_check
      pipelines:
        metrics:
          receivers:
            - hostmetrics
          processors:
            - resourcedetection
          exporters:
            - otlp_grpc
