apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Name }}-config
  namespace: default
data:
  relay: |
    exporters:
      otlp:
        endpoint: {{ .HostEndpoint }}:4317
        tls:
          insecure: true
    extensions:
      health_check:
        endpoint: 0.0.0.0:13133
    processors:
      resourcedetection:
        detectors: [azure]
        timeout: 2s
        override: false
        azure:
          resource_attributes:
            cloud.availability_zone:
              enabled: true
          tags:
            - ^environment$
            - ^team$
    receivers:
      hostmetrics:
        collection_interval: 1s
        scrapers:
          cpu:
    service:
      telemetry:
        logs:
          level: "debug"
      extensions:
        - health_check
      pipelines:
        metrics:
          receivers:
            - hostmetrics
          processors:
            - resourcedetection
          exporters:
            - otlp
