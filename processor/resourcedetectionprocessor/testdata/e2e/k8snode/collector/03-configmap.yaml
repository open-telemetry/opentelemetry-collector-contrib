apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Name }}-config
  namespace: default
data:
  relay: |
    exporters:
      otlp:
        endpoint: {{ .HostEndpoint }}:4317
        tls:
          insecure: true
    extensions:
      health_check:
        endpoint: 0.0.0.0:13133
    processors:
      resourcedetection:
        detectors: [k8snode]
        timeout: 2s
        override: false
        k8snode:
          node_from_env_var: "K8S_NODE_NAME"
    receivers:
      hostmetrics:
        collection_interval: 1s
        scrapers:
          cpu:
    service:
      telemetry:
        logs:
          level: "debug"
      extensions:
        - health_check
      pipelines:
        metrics:
          receivers:
            - hostmetrics
          processors:
            - resourcedetection
          exporters:
            - otlp
