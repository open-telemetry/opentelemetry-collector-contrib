# StarRocks Exporter

<!-- status autogenerated section -->
| Status        |           |
| ------------- |-----------|
| Stability     | [alpha]: metrics   |
|               | [beta]: traces, logs   |
| Distributions | [contrib] |
<!-- end autogenerated section -->

This exporter supports sending OpenTelemetry data to [StarRocks](https://www.starrocks.io/).

StarRocks is a high-performance analytical database that is MySQL-compatible. This exporter uses the MySQL protocol to connect to StarRocks and insert telemetry data.

## Configuration options

The following settings are required:

- `endpoint` (no default): The StarRocks MySQL endpoint in format `host:port` (e.g., `localhost:9030`).
- `username` (default = ): The authentication username.
- `password` (default = ): The authentication password.
- `database` (default = default): The database name to export.

Connection options:

- `connection_params` (default = {}): Extra connection parameters with map format.
- `create_schema` (default = true): When set to true, will run DDL to create the database and tables.
- `max_open_conns` (default = 10): Maximum number of open connections to the database.
- `max_idle_conns` (default = 5): Maximum number of idle connections in the pool.
- `conn_max_lifetime` (default = 5m): Maximum amount of time a connection may be reused.

StarRocks tables:

- `logs_table_name` (default = otel_logs): The table name for logs.
- `traces_table_name` (default = otel_traces): The table name for traces.
- `metrics_tables`
    - `gauge`
        - `name` (default = "otel_metrics_gauge")
    - `sum`
        - `name` (default = "otel_metrics_sum")
    - `summary`
        - `name` (default = "otel_metrics_summary")
    - `histogram`
        - `name` (default = "otel_metrics_histogram")
    - `exponential_histogram`
        - `name` (default = "otel_metrics_exponential_histogram")

Processing:

- `timeout` (default = 5s): The timeout for every attempt to send data to the backend.
- `sending_queue`
    - `enabled` (default = true)
    - `num_consumers` (default = 10): Number of consumers that dequeue batches.
    - `queue_size` (default = 1000): Maximum number of batches kept in memory before dropping data.
- `retry_on_failure`
    - `enabled` (default = true)
    - `initial_interval` (default = 5s): The time to wait after the first failure before retrying.
    - `max_interval` (default = 30s): The upper bound on backoff.
    - `max_elapsed_time` (default = 300s): The maximum amount of time spent trying to send a batch.

## Example Config

This example shows how to configure the exporter to send data to a StarRocks server.

```yaml
receivers:
  examplereceiver:
exporters:
  starrocks:
    endpoint: localhost:9030
    username: root
    password: password
    database: otel
    create_schema: true
    logs_table_name: otel_logs
    traces_table_name: otel_traces
    timeout: 5s
    metrics_tables:
      gauge: 
        name: "otel_metrics_gauge"
      sum: 
        name: "otel_metrics_sum"
      summary: 
        name: "otel_metrics_summary"
      histogram: 
        name: "otel_metrics_histogram"
      exponential_histogram: 
        name: "otel_metrics_exponential_histogram"
    retry_on_failure:
      enabled: true
      initial_interval: 5s
      max_interval: 30s
      max_elapsed_time: 300s
service:
  pipelines:
    logs:
      receivers: [ examplereceiver ]
      exporters: [ starrocks ]
```

## Schema Management

By default, the exporter will create the database and tables under the names defined in the config. This is fine for simple deployments, but for production workloads, it is recommended that you manage your own schema by setting `create_schema` to `false` in the config.

The default DDL used by the exporter can be found in `internal/sqltemplates`.

## Notes

- StarRocks uses MySQL-compatible SQL syntax, so the exporter uses the MySQL driver.
- Data is stored in JSON columns for complex attributes (resource attributes, span attributes, etc.).
- The exporter uses dynamic partitioning for time-based data management.
- Make sure your StarRocks cluster has sufficient resources to handle the data ingestion rate.

## Table Examples

For detailed examples of table schemas, sample data, and query examples for `otel_logs`, `otel_traces`, and `otel_metrics` tables, see [EXAMPLES.md](./EXAMPLES.md).

The examples document includes:
- Complete table schemas
- Sample INSERT statements
- Query examples for common use cases
- JSON structure examples
- Best practices and optimization tips

## Comparison with ClickHouse Exporter

For a detailed comparison between StarRocks Exporter and ClickHouse Exporter, including architecture differences, performance characteristics, and use case recommendations, see [COMPARISON.md](./COMPARISON.md).

The comparison document covers:
- Protocol and connection differences
- Data type structures (Map vs JSON)
- SQL syntax and table engines
- Performance characteristics
- Query examples
- Migration paths
- Use case recommendations

