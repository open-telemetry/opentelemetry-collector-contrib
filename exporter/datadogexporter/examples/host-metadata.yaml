receivers:
  otlp:
    protocols:
      http:
        endpoint: "localhost:4318"
      grpc:
        endpoint: "localhost:4317"
processors:
  probabilistic_sampler:
    sampling_percentage: 20
  transform:
    metric_statements:
      - context: resource
        statements:
          - set(attributes["datadog.host.use_as_metadata"], true)
    trace_statements:
      - context: resource
        statements:
          - set(attributes["datadog.host.use_as_metadata"], true)
connectors:
    datadog/connector:
exporters:
  datadog:
    api:
      key: ${env:DD_API_KEY}
      site: ${env:DD_SITE}
    sending_queue:
      batch:
service:
  pipelines:
    traces:
      receivers: [otlp]
      processors: [transform]
      exporters: [datadog/connector]
    traces/sampling:
      receivers: [datadog/connector]
      processors: [probabilistic_sampler]
      exporters: [datadog]
    metrics:
      receivers: [datadog/connector]
      processors: [transform]
      exporters: [datadog]
