# Sentry Exporter

<!-- status autogenerated section -->
| Status        |           |
| ------------- |-----------|
| Stability     | [alpha]: traces, logs   |
| Distributions | [contrib] |
| Issues        | [![Open issues](https://img.shields.io/github/issues-search/open-telemetry/opentelemetry-collector-contrib?query=is%3Aissue%20is%3Aopen%20label%3Aexporter%2Fsentry%20&label=open&color=orange&logo=opentelemetry)](https://github.com/open-telemetry/opentelemetry-collector-contrib/issues?q=is%3Aopen+is%3Aissue+label%3Aexporter%2Fsentry) [![Closed issues](https://img.shields.io/github/issues-search/open-telemetry/opentelemetry-collector-contrib?query=is%3Aissue%20is%3Aclosed%20label%3Aexporter%2Fsentry%20&label=closed&color=blue&logo=opentelemetry)](https://github.com/open-telemetry/opentelemetry-collector-contrib/issues?q=is%3Aclosed+is%3Aissue+label%3Aexporter%2Fsentry) |
| Code coverage | [![codecov](https://codecov.io/github/open-telemetry/opentelemetry-collector-contrib/graph/main/badge.svg?component=exporter_sentry)](https://app.codecov.io/gh/open-telemetry/opentelemetry-collector-contrib/tree/main/?components%5B0%5D=exporter_sentry&displayType=list) |
| [Code Owners](https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/CONTRIBUTING.md#becoming-a-code-owner)    | [@AbhiPrasad](https://www.github.com/AbhiPrasad) |

[alpha]: https://github.com/open-telemetry/opentelemetry-collector/blob/main/docs/component-stability.md#alpha
[contrib]: https://github.com/open-telemetry/opentelemetry-collector-releases/tree/main/distributions/otelcol-contrib
<!-- end autogenerated section -->

The Sentry Exporter allows you to send traces to [Sentry](https://sentry.io/).

For more details about distributed tracing in Sentry, please view [our documentation](https://docs.sentry.io/performance-monitoring/distributed-tracing/).

The exporter now operates only in dynamic mode. The following configuration options are supported:

- `url`: Base URL for the Sentry organization (required).
- `org_slug`: Target organization slug (required).
- `auth_token`: Authentication token with access to Sentry APIs (required).
- `routing`: Controls how telemetry is mapped to projects.
  - `attribute_for_project`: Resource attribute to use for routing (defaults to `service.name`).
  - `project_mapping`: Optional mapping from attribute value to project slug.
  - `auto_create_projects`: Automatically create projects when missing.
- `timeout`: HTTP timeout (defaults to 30s).
- `insecure_skip_verify`: Skip TLS verification (for testing only).
- `environment` (deprecated): Use resource attribute `deployment.environment` instead.

Example:

```yaml
exporters:
  sentry:
    url: https://sentry.io
    org_slug: my-org
    auth_token: ${SENTRY_AUTH_TOKEN}
    routing:
      auto_create_projects: true
      attribute_for_project: service.name
      project_mapping:
        api-service: backend-api
        web-service: frontend-web
    timeout: 30s
    insecure_skip_verify: false
```

See the [docs](./docs/transformation.md) for more details on how this transformation is working.

### Known Limitations

Currently, Sentry Tracing leverages a transaction-based system, where a transaction contains one or more spans. The exporter will try to group spans from a trace under one or more transactions based on internal heuristics, but this may lead to the creation of transactions that contain only one or two spans. These transactions will still be viewable and associated under a single trace in the Sentry UI.

One consequence of this result is that very large traces with a large number of spans (500+) and only one root span might be split up into a large number of transactions. There are no current ways to work around this.

### Associating with Sentry Errors

To associate OpenTelemetry spans with Sentry errors, you can set a trace context on the error event. Whenever you start a new trace, you can update the scope to reference a new `trace_id`.

An example with Python but applies to any language that supports a Sentry SDK.

```py
from sentry_sdk import configure_scope

with start_otel_span("start") as span:
  ctx = span.get_context()
  with configure_scope() as scope:
    scope.set_context("trace", {"trace_id": ctx.trace_id})

  with start_otel_span("child"):
    # ...
```

Now if traces are ingested into Sentry, you can associate them to errors that occurred during the trace using the `trace_id`. For a full list of the Sentry SDKs and platforms, please check the [Sentry documentation](https://docs.sentry.io/platforms/).
