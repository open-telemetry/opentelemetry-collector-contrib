# NATS Core Exporter

<!-- status autogenerated section -->
| Status        |           |
| ------------- |-----------|
| Stability     | [development]: metrics, logs, traces   |
| Distributions | [contrib] |
| Issues        | [![Open issues](https://img.shields.io/github/issues-search/open-telemetry/opentelemetry-collector-contrib?query=is%3Aissue%20is%3Aopen%20label%3Aexporter%2Fnatscore%20&label=open&color=orange&logo=opentelemetry)](https://github.com/open-telemetry/opentelemetry-collector-contrib/issues?q=is%3Aopen+is%3Aissue+label%3Aexporter%2Fnatscore) [![Closed issues](https://img.shields.io/github/issues-search/open-telemetry/opentelemetry-collector-contrib?query=is%3Aissue%20is%3Aclosed%20label%3Aexporter%2Fnatscore%20&label=closed&color=blue&logo=opentelemetry)](https://github.com/open-telemetry/opentelemetry-collector-contrib/issues?q=is%3Aclosed+is%3Aissue+label%3Aexporter%2Fnatscore) |
| Code coverage | [![codecov](https://codecov.io/github/open-telemetry/opentelemetry-collector-contrib/graph/main/badge.svg?component=exporter_natscore)](https://app.codecov.io/gh/open-telemetry/opentelemetry-collector-contrib/tree/main/?components%5B0%5D=exporter_natscore&displayType=list) |
| [Code Owners](https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/CONTRIBUTING.md#becoming-a-code-owner)    | [@EthanKim8683](https://www.github.com/EthanKim8683) |

[development]: https://github.com/open-telemetry/opentelemetry-collector/blob/main/docs/component-stability.md#development
[contrib]: https://github.com/open-telemetry/opentelemetry-collector-releases/tree/main/distributions/otelcol-contrib
<!-- end autogenerated section -->

NATS Core exporter exports logs, metrics and traces to [NATS Core](https://docs.nats.io/).

## Configuration

The following configuration options are supported:

- `endpoint` (default = nats://localhost:4222): The NATS server URL.
- `pedantic` (default = true): The option to enable/disable [NATS pedantic mode](https://docs.nats.io/nats-concepts/subjects#pedantic-mode).
- `tls`: See [TLS Configuration Settings](https://github.com/open-telemetry/opentelemetry-collector/blob/main/config/configtls/README.md) for the full set of available options.
- `logs`
  - `subject` (default = "otel_logs"): The [OTTL value expression](https://pkg.go.dev/text/template) used to construct NATS subjects for logs.
  - `marshaler` (default = otlp_proto): The name of the built-in marshaler used to marshal logs. See [Built-in Marshalers](#built-in-marshalers).
  - `encoding_extension`: The name of the encoding extension used to marshal logs. This configuration option is mutually exclusive with `marshaler`. See [Encoding extensions](https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/extension/encoding/README.md).
- `metrics`
  - `subject` (default = "otel_metrics"): The [OTTL value expression](https://pkg.go.dev/text/template) used to construct NATS subjects for metrics.
  - `marshaler` (default = otlp_proto): The name of the built-in marshaler used to marshal metrics. See [Built-in Marshalers](#built-in-marshalers).
  - `encoding_extension`: The name of the encoding extension used to marshal metrics. This configuration option is mutually exclusive with `marshaler`. See [Encoding extensions](https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/extension/encoding/README.md).
- `traces`
  - `subject` (default = "otel_traces"): The [OTTL value expression](https://pkg.go.dev/text/template) used to construct NATS subjects for traces.
  - `marshaler` (default = otlp_proto): The name of the built-in marshaler used to marshal traces. See [Built-in Marshalers](#built-in-marshalers).
  - `encoding_extension`: The name of the encoding extension used to marshal traces. This configuration option is mutually exclusive with `marshaler`. See [Encoding extensions](https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/extension/encoding/README.md).
- `auth`
  - `token`: Configuration options for [token auth](https://docs.nats.io/running-a-nats-service/configuration/securing_nats/auth_intro/tokens).
    - `token`: The plaintext token.
  - `user`: Configuration options for [username/password auth](https://docs.nats.io/running-a-nats-service/configuration/securing_nats/auth_intro/username_password).
    - `username`: The plaintext username.
    - `password`: The plaintext password.
  - `nkey`: Configuration options for [NKey auth](https://docs.nats.io/running-a-nats-service/configuration/securing_nats/auth_intro/nkey_auth).
    - `public_key`: The public key.
    - `seed`: The seed.
  - `nkey_jwt`: Configuration options for [decentralized NKey auth via JWT](https://docs.nats.io/running-a-nats-service/configuration/securing_nats/auth_intro/jwt).
    - `jwt`: The JWT.
    - `seed`: The seed.
  - `nkey_user_file`: Configuration options for [decentralized NKey auth via user file](https://docs.nats.io/using-nats/developer/connecting/creds).
    - `user_file`: The path to the user file.

### Built-in marshalers

NATS Core exporter has built-in marshalers for the following built-in encodings:

- `otlp_proto`: Signals are encoded as OTLP Protobuf.
- `otlp_json`: Signals are encoded as OTLP JSON.

## Example Configurations

### Dynamic subjects

To support [subject-based filtering](https://docs.nats.io/nats-concepts/subjects#subject-based-filtering-and-security), NATS Core exporter constructs dynamic subjects using [OTTL value expressions](https://pkg.go.dev/text/template).

Below is an example of dynamic subjects for traces:

```yaml
natscoreexporter:
  traces:
    subject: 'Format("traces.%s.spans.%s", [span.trace_id, span.span_id])'
```
