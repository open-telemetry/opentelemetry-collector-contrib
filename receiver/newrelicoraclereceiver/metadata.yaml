type: newrelicoracledb

status:
  class: receiver
  stability:
    alpha: [metrics]
  distributions: [contrib]
  codeowners:
    active: [newrelic-team]

resource_attributes:
  newrelicoracledb.instance.name:
    description: The name of the Oracle instance that data is coming from.
    enabled: true
    type: string
  host.name:
    description: The host name of Oracle Server
    enabled: true
    type: string

attributes:
  newrelic.entity_name:
    description: New Relic entity name for the metric
    type: string
  tablespace.name:
    description: Name of the Oracle tablespace
    type: string
  instance.id:
    description: Oracle database instance ID
    type: string
  global.name:
    description: Oracle database global name
    type: string
  db.id:
    description: Oracle database ID
    type: string

metrics:
  newrelicoracledb.sessions.count:
    description: Total number of active Oracle database sessions
    enabled: true
    gauge:
      value_type: int
    unit: "{sessions}"
    attributes:
      - newrelic.entity_name

  newrelicoracledb.tablespace.space_consumed_bytes:
    description: Total bytes consumed by the tablespace
    enabled: true
    gauge:
      value_type: int
    unit: "By"
    attributes:
      - newrelic.entity_name
      - tablespace.name

  newrelicoracledb.tablespace.space_reserved_bytes:
    description: Total bytes reserved by the tablespace
    enabled: true
    gauge:
      value_type: int
    unit: "By"
    attributes:
      - newrelic.entity_name
      - tablespace.name

  newrelicoracledb.tablespace.space_used_percentage:
    description: Percentage of tablespace space currently used
    enabled: true
    gauge:
      value_type: int
    unit: "%"
    attributes:
      - newrelic.entity_name
      - tablespace.name

  newrelicoracledb.tablespace.is_offline:
    description: Whether the tablespace is offline (1) or online (0)
    enabled: true
    gauge:
      value_type: int
    unit: "1"
    attributes:
      - newrelic.entity_name
      - tablespace.name

  newrelicoracledb.tablespace.global_name:
    description: Global name information for tablespace
    enabled: true
    gauge:
      value_type: int
    unit: "1"
    attributes:
      - newrelic.entity_name
      - tablespace.name

  newrelicoracledb.tablespace.db_id:
    description: Database ID information for tablespace
    enabled: true
    gauge:
      value_type: int
    unit: "1"
    attributes:
      - newrelic.entity_name
      - tablespace.name

  newrelicoracledb.tablespace.offline_cdb_datafiles:
    description: Count of offline CDB datafiles by tablespace
    enabled: true
    gauge:
      value_type: int
    unit: "1"
    attributes:
      - newrelic.entity_name
      - tablespace.name

  newrelicoracledb.tablespace.offline_pdb_datafiles:
    description: Count of offline PDB datafiles by tablespace
    enabled: true
    gauge:
      value_type: int
    unit: "1"
    attributes:
      - newrelic.entity_name
      - tablespace.name

  newrelicoracledb.tablespace.pdb_non_write_mode:
    description: Count of PDB datafiles in non-write mode by tablespace
    enabled: true
    gauge:
      value_type: int
    unit: "1"
    attributes:
      - newrelic.entity_name
      - tablespace.name

  newrelicoracledb.locked_accounts:
    description: Count of locked user accounts in the database
    enabled: true
    gauge:
      value_type: int
    unit: "1"
    attributes:
      - newrelic.entity_name
      - instance.id

  newrelicoracledb.disk.reads:
    description: Number of physical disk reads
    enabled: true
    gauge:
      value_type: int
    unit: "1"
    attributes:
      - newrelic.entity_name
      - instance.id

  newrelicoracledb.disk.writes:
    description: Number of physical disk writes
    enabled: true
    gauge:
      value_type: int
    unit: "1"
    attributes:
      - newrelic.entity_name
      - instance.id

  newrelicoracledb.disk.blocks_read:
    description: Number of physical blocks read from disk
    enabled: true
    gauge:
      value_type: int
    unit: "1"
    attributes:
      - newrelic.entity_name
      - instance.id

  newrelicoracledb.disk.blocks_written:
    description: Number of physical blocks written to disk
    enabled: true
    gauge:
      value_type: int
    unit: "1"
    attributes:
      - newrelic.entity_name
      - instance.id

  newrelicoracledb.disk.read_time_milliseconds:
    description: Time spent reading from disk in milliseconds
    enabled: true
    gauge:
      value_type: int
    unit: "ms"
    attributes:
      - newrelic.entity_name
      - instance.id

  newrelicoracledb.disk.write_time_milliseconds:
    description: Time spent writing to disk in milliseconds
    enabled: true
    gauge:
      value_type: int
    unit: "ms"
    attributes:
      - newrelic.entity_name
      - instance.id

  newrelicoracledb.memory.pga_in_use_bytes:
    description: Total PGA memory currently in use in bytes
    enabled: true
    gauge:
      value_type: int
    unit: "By"
    attributes:
      - newrelic.entity_name
      - instance.id

  newrelicoracledb.memory.pga_allocated_bytes:
    description: Total PGA memory allocated in bytes
    enabled: true
    gauge:
      value_type: int
    unit: "By"
    attributes:
      - newrelic.entity_name
      - instance.id

  newrelicoracledb.memory.pga_freeable_bytes:
    description: Total freeable PGA memory in bytes
    enabled: true
    gauge:
      value_type: int
    unit: "By"
    attributes:
      - newrelic.entity_name
      - instance.id

  newrelicoracledb.memory.pga_max_size_bytes:
    description: Global memory bound for PGA in bytes
    enabled: true
    gauge:
      value_type: int
    unit: "By"
    attributes:
      - newrelic.entity_name
      - instance.id

  newrelicoracledb.global_name:
    description: Oracle database global name information
    enabled: true
    gauge:
      value_type: int
    unit: "1"
    attributes:
      - newrelic.entity_name
      - instance.id
      - global.name

  newrelicoracledb.db_id:
    description: Oracle database ID information
    enabled: true
    gauge:
      value_type: int
    unit: "1"
    attributes:
      - newrelic.entity_name
      - instance.id
      - db.id

  newrelicoracledb.long_running_queries:
    description: Number of long running queries (active sessions running for more than 60 seconds)
    enabled: true
    gauge:
      value_type: int
    unit: "1"
    attributes:
      - newrelic.entity_name
      - instance.id

  newrelicoracledb.memory.sga_uga_total_bytes:
    description: Total SGA UGA memory in bytes (session uga memory max)
    enabled: true
    gauge:
      value_type: int
    unit: "By"
    attributes:
      - newrelic.entity_name
      - instance.id

  newrelicoracledb.memory.sga_shared_pool_library_cache_sharable_bytes:
    description: SGA shared pool library cache sharable memory in bytes for statements with more than 5 executions
    enabled: true
    gauge:
      value_type: int
    unit: "By"
    attributes:
      - newrelic.entity_name
      - instance.id

  newrelicoracledb.memory.sga_shared_pool_library_cache_user_bytes:
    description: SGA shared pool library cache shareable memory per user in bytes (250 * users_opening)
    enabled: true
    gauge:
      value_type: int
    unit: "By"
    attributes:
      - newrelic.entity_name
      - instance.id

tests:
  config:
  goleak:
    ignore:
      any:
      - "github.com/cihub/seelog.(*asyncLoopLogger).processQueue" # see https://github.com/cihub/seelog/issues/182
