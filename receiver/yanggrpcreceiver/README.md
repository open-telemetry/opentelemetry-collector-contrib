# YANG gRPC receiver

<!-- status autogenerated section -->
| Status        |           |
| ------------- |-----------|
| Stability     | [alpha]: metrics   |
| Distributions | [] |
| Issues        | [![Open issues](https://img.shields.io/github/issues-search/open-telemetry/opentelemetry-collector-contrib?query=is%3Aissue%20is%3Aopen%20label%3Areceiver%2Fyanggrpc%20&label=open&color=orange&logo=opentelemetry)](https://github.com/open-telemetry/opentelemetry-collector-contrib/issues?q=is%3Aopen+is%3Aissue+label%3Areceiver%2Fyanggrpc) [![Closed issues](https://img.shields.io/github/issues-search/open-telemetry/opentelemetry-collector-contrib?query=is%3Aissue%20is%3Aclosed%20label%3Areceiver%2Fyanggrpc%20&label=closed&color=blue&logo=opentelemetry)](https://github.com/open-telemetry/opentelemetry-collector-contrib/issues?q=is%3Aclosed+is%3Aissue+label%3Areceiver%2Fyanggrpc) |
| Code coverage | [![codecov](https://codecov.io/github/open-telemetry/opentelemetry-collector-contrib/graph/main/badge.svg?component=receiver_yanggrpc)](https://app.codecov.io/gh/open-telemetry/opentelemetry-collector-contrib/tree/main/?components%5B0%5D=receiver_yanggrpc&displayType=list) |
| [Code Owners](https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/CONTRIBUTING.md#becoming-a-code-owner)    | [@atoulme](https://www.github.com/atoulme) |

[alpha]: https://github.com/open-telemetry/opentelemetry-collector/blob/main/docs/component-stability.md#alpha
<!-- end autogenerated section -->

The YANG/gRPC receiver receives metrics offered using the [YANG (Yet Another New Generation) data model](https://en.wikipedia.org/wiki/YANG), expressed over [gRPC](https://ciscolearning.github.io/cisco-learning-codelabs/posts/yangsuite-restconf/#0).

The receiver exposes a gRPC endpoint, accepting the gRPC configuration offered by the [configgrpc](https://pkg.go.dev/go.opentelemetry.io/collector/config/configgrpc) module.

# Configuration

## Definition

### gRPC Configuration

See [configgrpc](https://pkg.go.dev/go.opentelemetry.io/collector/config/configgrpc).

The default configuration sets up the following parameters:

```yaml
  endpoint: localhost:57500
  transport: tcp
  keepalive:
    server_parameters:
      time: 30s
      timeout: 10s
  max_concurrent_streams: 100
  max_recv_msg_size_mib: 4
```

### Security Configuration (`security`)

#### Rate Limiting (`rate_limiting`)

##### `enabled`
- **Type**: `bool`
- **Default**: `false`
- **Description**: Enable per-client rate limiting

##### `requests_per_second`
- **Type**: `float64`
- **Default**: `100.0`
- **Description**: Maximum requests per second per client

##### `burst_size`
- **Type**: `int`
- **Default**: `10`
- **Description**: Burst allowance for rate limiting

##### `cleanup_interval`
- **Type**: `duration`
- **Default**: `1m`
- **Description**: How often to clean up rate limiter entries

#### Access Control

##### `allowed_clients`
- **Type**: `[]string`
- **Default**: `[]` (allow all)
- **Description**: IP addresses or CIDR blocks allowed to connect
- **Examples**:
  ```yaml
  allowed_clients:
    - "10.1.1.100"           # Specific IP
    - "192.168.0.0/16"       # CIDR block
    - "10.0.0.0/8"           # Large network
  ```

##### `max_connections`
- **Type**: `int`
- **Default**: `1000`
- **Description**: Maximum concurrent connections

##### `connection_timeout`
- **Type**: `duration`
- **Default**: `30s`
- **Description**: Timeout for new connections

##### `enable_metrics`
- **Type**: `bool`
- **Default**: `true`
- **Description**: Enable security-related metrics collection

## Performance Tuning

### Keep-Alive Configuration (`keep_alive`)

#### `time`
- **Type**: `duration`
- **Default**: `30s`
- **Description**: Time between keep-alive pings

#### `timeout`
- **Type**: `duration`
- **Default**: `10s`
- **Description**: Timeout waiting for keep-alive response

## YANG Parser Settings

### YANG Configuration (`yang`)

#### `enable_rfc_parser`
- **Type**: `bool`
- **Default**: `true`
- **Description**: Enable RFC 6020/7950 compliant YANG parser

#### `cache_modules`
- **Type**: `bool`
- **Default**: `true`
- **Description**: Cache discovered YANG modules

#### `max_modules`
- **Type**: `int`
- **Default**: `1000`
- **Description**: Maximum number of YANG modules to cache

## Default

```yaml
yanggrpc:
  endpoint: localhost:57500
  transport: tcp
  keepalive:
    server_parameters:
      time: 30s
      timeout: 10s
  max_concurrent_streams: 100
  max_recv_msg_size_mib: 4
  security:
    connection_timeout: 30s
    enable_metrics: true
    rate_limiting:
      burst_size: 10
      cleanup_interval: 1m0s
      enabled: false
      requests_per_second: 100
  yang:
    cache_modules: true
    enable_rfc_parser: true
    max_modules: 1000
```

## Production

```yaml
yanggrpc:
  endpoint: "0.0.0.0:57500"
  # TLS/mTLS Configuration
  tls:
    enabled: true
    cert_file: "/etc/otel/certs/server.crt"
    key_file: "/etc/otel/certs/server.key"
    ca_file: "/etc/otel/certs/ca.crt"
    client_auth_type: "RequireAndVerifyClientCert"
    min_version: "1.2"
    max_version: "1.3"
    reload_interval: 5m
    
  # Security & Rate Limiting
  security:
    rate_limiting:
      enabled: true
      requests_per_second: 100.0
      burst_size: 10
      cleanup_interval: 1m
    allowed_clients: 
      - "10.0.0.0/8"
      - "192.168.0.0/16"
    max_connections: 1000
    connection_timeout: 30s
    enable_metrics: true
    
    # Performance Settings
    max_concurrent_streams: 100
    max_recv_msg_size_mib: 4
    
    # Keep-Alive Configuration
    keepalive:
      server_parameters:
        time: 30s
        timeout: 10s
    
    # YANG Parser Configuration
    yang:
      enable_rfc_parser: true
      cache_modules: true
      max_modules: 1000
```
