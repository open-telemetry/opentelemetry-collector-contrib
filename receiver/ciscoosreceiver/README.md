# Cisco OS Receiver

<!-- status autogenerated section -->
| Status        |           |
| ------------- |-----------|
| Stability     | [alpha]: metrics   |
| Distributions | [] |
| Issues        | [![Open issues](https://img.shields.io/github/issues-search/open-telemetry/opentelemetry-collector-contrib?query=is%3Aissue%20is%3Aopen%20label%3Areceiver%2Fciscoos%20&label=open&color=orange&logo=opentelemetry)](https://github.com/open-telemetry/opentelemetry-collector-contrib/issues?q=is%3Aopen+is%3Aissue+label%3Areceiver%2Fciscoos) [![Closed issues](https://img.shields.io/github/issues-search/open-telemetry/opentelemetry-collector-contrib?query=is%3Aissue%20is%3Aclosed%20label%3Areceiver%2Fciscoos%20&label=closed&color=blue&logo=opentelemetry)](https://github.com/open-telemetry/opentelemetry-collector-contrib/issues?q=is%3Aclosed+is%3Aissue+label%3Areceiver%2Fciscoos) |
| Code coverage | [![codecov](https://codecov.io/github/open-telemetry/opentelemetry-collector-contrib/graph/main/badge.svg?component=receiver_ciscoos)](https://app.codecov.io/gh/open-telemetry/opentelemetry-collector-contrib/tree/main/?components%5B0%5D=receiver_ciscoos&displayType=list) |
| [Code Owners](https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/CONTRIBUTING.md#becoming-a-code-owner)    | [@dmitryax](https://www.github.com/dmitryax) |

[alpha]: https://github.com/open-telemetry/opentelemetry-collector/blob/main/docs/component-stability.md#alpha
<!-- end autogenerated section -->

The Cisco OS Receiver is a modular receiver that collects metrics from Cisco network devices via SSH connections. It supports multiple devices and scrapers for comprehensive network monitoring and provides native OpenTelemetry OTLP metrics generation.

## Configuration

The receiver configuration includes:

| Setting | Type | Required | Description |
|---------|------|----------|-------------|
| `collection_interval` | duration | No | How often to collect metrics (default: 60s) |
| `timeout` | duration | No | SSH connection and command timeout (default: 10s) |
| `devices` | list | Yes | List of Cisco devices to monitor |
| `scrapers` | map | Yes | Scraper configuration with metric toggles |

### Device Configuration

Each device in the `devices` list has the following settings:

| Setting | Type | Required | Description |
|---------|------|----------|-------------|
| `name` | string | No | Human-readable device name |
| `host` | string | Yes | Device IP address or hostname |
| `port` | int | Yes | SSH port (typically 22) |
| `auth.username` | string | Yes | SSH username for authentication |
| `auth.password` | string | No* | Password for authentication |
| `auth.key_file` | string | No* | Path to SSH private key file |

*At least one of `auth.password` or `auth.key_file` is required. Both can be provided for fallback authentication (key file is tried first).

**Authentication Methods:**
- **Password authentication**: Provide `auth.password`
- **SSH key file authentication**: Provide `auth.key_file` (path to private key)
  - Supports unencrypted keys in RSA, ECDSA, Ed25519 formats
  - Supports both PEM and OpenSSH formats
  - Encrypted keys are not supported
- **Fallback authentication**: Provide both `auth.password` and `auth.key_file`
  - Key file is tried first, password is used as fallback if key authentication fails

### Scrapers Configuration

Scrapers define which metrics to collect from all devices.

| Scraper | Description |
|---------|-------------|
| `system` | System metrics (device availability, CPU, memory) |
| `interfaces` | Interface metrics (traffic, errors, status) |

**Metric Enable Behavior:**
- If a scraper is specified without a `metrics` section, **all metrics for that scraper are enabled by default**
- Use `enabled: false` to disable specific metrics

## Metrics Collected

### System Metrics
- `cisco.device.up` - Device availability (1=up, 0=down)
- `system.cpu.utilization` - CPU utilization as a percentage (0-1)
  - NX-OS: Calculated from `show system resources` (user + kernel)
  - IOS/IOS XE: Calculated from `show process cpu` (5-second average)
- `system.memory.utilization` - Memory utilization as a percentage (0-1)
  - NX-OS: Calculated from `show system resources` (used / total)
  - IOS/IOS XE: Calculated from `show process memory` (Processor Pool used / total)

### Interface Metrics
- `system.network.io` - Number of bytes transmitted and received (with `network.io.direction` attribute: `receive` or `transmit`)
- `system.network.errors` - Number of errors encountered (with `network.io.direction` attribute: `receive` or `transmit`)
- `system.network.packet.dropped` - Number of packets dropped (with `network.io.direction` attribute: `receive` or `transmit`)
- `system.network.packet.count` - Number of packets transmitted or received, categorized by type (with `network.packet.type` attribute: `multicast` or `broadcast`)
- `system.network.interface.status` - Interface operational status (1 = up, 0 = down)

Interface metrics include attributes: `network.interface.name`, `network.interface.mac`, `network.interface.description`, `network.interface.speed`

Metrics with direction attribute also include: `network.io.direction` (enum: `receive`, `transmit`)

Metrics with packet type attribute also include: `network.packet.type` (enum: `multicast`, `broadcast`)

### Resource Attributes
All metrics include the following resource attributes following OpenTelemetry semantic conventions:
- `host.ip` - Device IP address for correlation with Kubernetes nodes and other resources
- `hw.type` - Hardware type, set to "network" per OpenTelemetry hardware.network conventions
- `os.name` - Operating system name (e.g., "NX-OS", "IOS XE", "IOS")

## Example Configuration

### Basic Multi-Device Configuration

```yaml
receivers:
  ciscoos:
    collection_interval: 60s
    timeout: 30s
    
    # Scrapers applied to all devices
    # All metrics are enabled by default when scraper is specified
    scrapers:
      system:
        metrics:
      interfaces:
        metrics:
    
    # List of devices to monitor
    devices:
      - name: "core-switch-01"
        host: "192.168.1.10"
        port: 22
        auth:
          username: "admin"
          password: "secure-password"
      
      - name: "edge-router-01"
        host: "192.168.1.20"
        port: 22
        auth:
          username: "admin"
          key_file: "/home/user/.ssh/id_rsa"
      
      - name: "firewall-01"
        host: "192.168.1.30"
        port: 22
        auth:
          username: "admin"
          key_file: "/home/user/.ssh/id_rsa"
          password: "backup-password"  # Fallback if key auth fails

exporters:
  debug:

service:
  pipelines:
    metrics:
      receivers: [ciscoos]
      exporters: [debug]
```