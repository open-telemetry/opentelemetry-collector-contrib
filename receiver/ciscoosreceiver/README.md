# Cisco OS Receiver

<!-- status autogenerated section -->
| Status        |           |
| ------------- |-----------|
| Stability     | [alpha]: metrics   |
| Distributions | [] |
| Issues        | [![Open issues](https://img.shields.io/github/issues-search/open-telemetry/opentelemetry-collector-contrib?query=is%3Aissue%20is%3Aopen%20label%3Areceiver%2Fciscoos%20&label=open&color=orange&logo=opentelemetry)](https://github.com/open-telemetry/opentelemetry-collector-contrib/issues?q=is%3Aopen+is%3Aissue+label%3Areceiver%2Fciscoos) [![Closed issues](https://img.shields.io/github/issues-search/open-telemetry/opentelemetry-collector-contrib?query=is%3Aissue%20is%3Aclosed%20label%3Areceiver%2Fciscoos%20&label=closed&color=blue&logo=opentelemetry)](https://github.com/open-telemetry/opentelemetry-collector-contrib/issues?q=is%3Aclosed+is%3Aissue+label%3Areceiver%2Fciscoos) |
| Code coverage | [![codecov](https://codecov.io/github/open-telemetry/opentelemetry-collector-contrib/graph/main/badge.svg?component=receiver_ciscoosreceiver)](https://app.codecov.io/gh/open-telemetry/opentelemetry-collector-contrib/tree/main/?components%5B0%5D=receiver_ciscoosreceiver&displayType=list) |
| [Code Owners](https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/CONTRIBUTING.md#becoming-a-code-owner)    | [@dmitryax](https://www.github.com/dmitryax) |

[alpha]: https://github.com/open-telemetry/opentelemetry-collector/blob/main/docs/component-stability.md#alpha
<!-- end autogenerated section -->

The Cisco OS Receiver is a modular receiver that collects metrics from Cisco network devices via SSH connections. It supports multiple scrapers for comprehensive network monitoring and provides native OpenTelemetry OTLP metrics generation.

## Configuration

The following settings are available:

| Setting | Type | Required | Description |
|---------|------|----------|-------------|
| `device` | DeviceConfig | Yes | Cisco device to monitor |
| `collection_interval` | duration | No | How often to collect metrics (default: 60s) |
| `timeout` | duration | No | SSH connection and command timeout (default: 30s) |
| `scrapers` | map | Yes | Scrapers to enable |

**Note:** Each receiver instance monitors a single device. To monitor multiple devices, create multiple receiver instances with unique identifiers (e.g., `ciscoosreceiver/device1`, `ciscoosreceiver/device2`).

### Device Configuration

Each device configuration contains device information and authentication settings following semantic conventions:

| Setting | Type | Required | Description |
|---------|------|----------|-------------|
| `device.host.name` | string | No | Human-readable device name |
| `device.host.ip` | string | Yes | Device IP address |
| `device.host.port` | int | Yes | SSH port (typically 22) |
| `auth.username` | string | Yes | SSH username for authentication |
| `auth.password` | string | No* | Password for authentication |
| `auth.key_file` | string | No* | Path to SSH private key file (supports RSA, ECDSA, Ed25519 in PEM or OpenSSH format) |

*At least one of `auth.password` or `auth.key_file` is required. Both can be provided for fallback authentication (key file is tried first).

**Authentication Methods:**
- **Password authentication**: Provide `auth.password`
- **SSH key file authentication**: Provide `auth.key_file` (path to private key)
  - Supports unencrypted keys in RSA, ECDSA, Ed25519 formats
  - Supports both PEM and OpenSSH formats
  - Encrypted keys are not supported
- **Fallback authentication**: Provide both `auth.password` and `auth.key_file`
  - Key file is tried first, password is used as fallback if key authentication fails

### Scrapers Configuration

The scrapers are configured as modular components. Each scraper type can be configured individually:

| Setting | Type | Description |
|---------|------|-------------|
| `system` | map | System metrics (device availability, CPU, memory) |
| `interfaces` | map | Interface metrics (traffic, errors, status) |

## Metrics Collected

### System Metrics
- `cisco.device.up` - Device availability (1=up, 0=down)
- `system.cpu.utilization` - CPU utilization as a percentage (0-1)
  - NX-OS: Calculated from `show system resources` (user + kernel)
  - IOS/IOS XE: Calculated from `show process cpu` (5-second average)
- `system.memory.utilization` - Memory utilization as a percentage (0-1)
  - NX-OS: Calculated from `show system resources` (used / total)
  - IOS/IOS XE: Calculated from `show process memory` (Processor Pool used / total)

### Interface Metrics
- `system.network.io` - Number of bytes transmitted and received (with `network.io.direction` attribute: `receive` or `transmit`)
- `system.network.errors` - Number of errors encountered (with `network.io.direction` attribute: `receive` or `transmit`)
- `system.network.packet.dropped` - Number of packets dropped (with `network.io.direction` attribute: `receive` or `transmit`)
- `system.network.packet.count` - Number of packets transmitted or received, categorized by type (with `network.packet.type` attribute: `multicast` or `broadcast`)
- `system.network.interface.status` - Interface operational status (1 = up, 0 = down)

Interface metrics include attributes: `network.interface.name`, `network.interface.mac`, `network.interface.description`, `network.interface.speed`

Metrics with direction attribute also include: `network.io.direction` (enum: `receive`, `transmit`)

Metrics with packet type attribute also include: `network.packet.type` (enum: `multicast`, `broadcast`)

### Resource Attributes
All metrics include the following resource attributes following OpenTelemetry semantic conventions:
- `host.ip` - Device IP address for correlation with Kubernetes nodes and other resources
- `hw.type` - Hardware type, set to "network" per OpenTelemetry hardware.network conventions
- `os.name` - Operating system name (e.g., "NX-OS", "IOS XE", "IOS")

## Example Configuration

```yaml
receivers:
  # Example 1: Password authentication
  ciscoosreceiver/switch01:
    collection_interval: 60s
    timeout: 30s
    device:
      device:
        host:
          name: "core-switch-01"
          ip: "192.168.1.10"
          port: 22
      auth:
        username: "admin"
        password: "secure-password"
    scrapers:
      system:
        metrics:
          cisco.device.up:
            enabled: true
          system.cpu.utilization:
            enabled: true
          system.memory.utilization:
            enabled: true
      interfaces:
        metrics:
          system.network.io:
            enabled: true
          system.network.errors:
            enabled: true
          system.network.packet.dropped:
            enabled: true
          system.network.packet.count:
            enabled: true
          system.network.interface.status:
            enabled: true

  # Example 2: SSH key file authentication
  ciscoosreceiver/router01:
    collection_interval: 60s
    timeout: 30s
    device:
      device:
        host:
          name: "edge-router-01"
          ip: "192.168.1.20"
          port: 22
      auth:
        username: "admin"
        key_file: "/home/user/.ssh/id_rsa"
    scrapers:
      system:
        metrics:
          cisco.device.up:
            enabled: true
          system.cpu.utilization:
            enabled: true
          system.memory.utilization:
            enabled: true

  # Example 3: Fallback authentication (key file with password backup)
  ciscoosreceiver/firewall01:
    collection_interval: 60s
    timeout: 30s
    device:
      device:
        host:
          name: "firewall-01"
          ip: "192.168.1.30"
          port: 22
      auth:
        username: "admin"
        key_file: "/home/user/.ssh/id_rsa"
        password: "backup-password"  # Used if key auth fails
    scrapers:
      system:
        metrics:
          cisco.device.up:
            enabled: true
          system.cpu.utilization:
            enabled: true
          system.memory.utilization:
            enabled: true

exporters:
  debug:

service:
  pipelines:
    metrics:
      receivers: [ciscoosreceiver/switch01, ciscoosreceiver/router01, ciscoosreceiver/firewall01]
      exporters: [debug]
```